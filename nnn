-- Load Rayfield UI Library
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Create the main window
local Window = Rayfield:CreateWindow({
    Name = "Player Manager",
    LoadingTitle = "Loading Player Manager...",
    LoadingSubtitle = "by YourName",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "PlayerManager",
        FileName = "Config"
    },
    Discord = {
        Enabled = false,
        Invite = "noinvitelink",
        RememberJoins = true
    },
    KeySystem = false,
    KeySettings = {
        Title = "Untitled",
        Subtitle = "Key System",
        Note = "No method of obtaining the key is provided",
        FileName = "Key",
        SaveKey = true,
        GrabKeyFromSite = false,
        Key = {"Hello"}
    }
})

-- Create the main tab
local MainTab = Window:CreateTab("Players", 4483362458) -- Example icon ID

-- Create the player dropdown section
local PlayerSection = MainTab:CreateSection("Player List")

-- Create the dropdown
local PlayerDropdown = MainTab:CreateDropdown({
    Name = "Select Player",
    Options = {},
    CurrentOption = "None",
    Flag = "PlayerDropdown",
    Callback = function(SelectedPlayer)
        if SelectedPlayer ~= "None" then
            print("Selected player:", SelectedPlayer)
            -- You can add actions for selected player here
        end
    end,
})

-- Function to update player list
local function UpdatePlayerList()
    local players = game:GetService("Players"):GetPlayers()
    local playerNames = {}
    
    table.insert(playerNames, "None") -- Add "None" option
    
    for _, player in ipairs(players) do
        if player and player.Name then
            table.insert(playerNames, player.Name)
        end
    end
    
    -- Update the dropdown options
    PlayerDropdown:SetOptions(playerNames)
    
    if #playerNames > 1 then
        PlayerDropdown:Set("None")
    end
end

-- Button to refresh player list
MainTab:CreateButton({
    Name = "Refresh Player List",
    Callback = function()
        UpdatePlayerList()
        Rayfield:Notify({
            Title = "Player List Updated",
            Content = "Player list has been refreshed.",
            Duration = 2,
            Image = 4483362458
        })
    end,
})

-- Function to auto-update when players join/leave
local function SetupPlayerTracking()
    -- Update initially
    UpdatePlayerList()
    
    -- Update when player joins
    game:GetService("Players").PlayerAdded:Connect(function(player)
        task.wait(1) -- Wait a moment for player to fully join
        UpdatePlayerList()
    end)
    
    -- Update when player leaves
    game:GetService("Players").PlayerRemoved:Connect(function(player)
        task.wait(1) -- Wait a moment to ensure player left
        UpdatePlayerList()
    end)
end

-- Start tracking players
SetupPlayerTracking()

-- Create some example player actions
local ActionsSection = MainTab:CreateSection("Player Actions")

-- Example: Teleport to player
MainTab:CreateButton({
    Name = "Teleport to Selected Player",
    Callback = function()
        local selectedPlayer = PlayerDropdown.CurrentOption
        if selectedPlayer and selectedPlayer ~= "None" then
            local target = game:GetService("Players"):FindFirstChild(selectedPlayer)
            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                local localPlayer = game:GetService("Players").LocalPlayer
                if localPlayer.Character and localPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    localPlayer.Character.HumanoidRootPart.CFrame = target.Character.HumanoidRootPart.CFrame
                    Rayfield:Notify({
                        Title = "Teleported",
                        Content = "Teleported to " .. selectedPlayer,
                        Duration = 3,
                        Image = 4483362458
                    })
                end
            end
        else
            Rayfield:Notify({
                Title = "No Player Selected",
                Content = "Please select a player first.",
                Duration = 3,
                Image = 4483362458
            })
        end
    end,
})

-- Example: View player info
MainTab:CreateButton({
    Name = "Show Player Info",
    Callback = function()
        local selectedPlayer = PlayerDropdown.CurrentOption
        if selectedPlayer and selectedPlayer ~= "None" then
            local target = game:GetService("Players"):FindFirstChild(selectedPlayer)
            if target then
                Rayfield:Notify({
                    Title = "Player Info: " .. selectedPlayer,
                    Content = "UserID: " .. target.UserId .. 
                             "\nAccount Age: " .. target.AccountAge .. " days" ..
                             "\nDisplay Name: " .. target.DisplayName,
                    Duration = 5,
                    Image = 4483362458
                })
            end
        else
            Rayfield:Notify({
                Title = "No Player Selected",
                Content = "Please select a player first.",
                Duration = 3,
                Image = 4483362458
            })
        end
    end,
})

-- Initialize the UI
Rayfield:Notify({
    Title = "Player Manager Loaded",
    Content = "Select a player from the dropdown to begin.",
    Duration = 5,
    Image = 4483362458
})
