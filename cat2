-- FINAL DEEP DIVE: quest_manager (works 100% on every join)
spawn(function()
    print("INSPECTING quest_manager - FULL DEEP DIVE")

    local ClientModules = nil
    while not ClientModules do
        ClientModules = game:GetService("ReplicatedStorage"):FindFirstChild("ClientModules")
        if ClientModules then break end
        task.wait(1)
    end

    local ClientData = require(ClientModules:WaitForChild("Core"):WaitForChild("ClientData"))
    local player = game.Players.LocalPlayer

    local data = nil
    while not data or not data.quest_manager do
        local success, result = pcall(function()
            return ClientData.get_data()[player.Name]
        end)
        if success and result then
            data = result
        end
        task.wait(1)
    end

    local manager = data.quest_manager
    print("quest_manager FOUND! DUMPING EVERYTHING:")

    for key, value in pairs(manager) do
        if typeof(value) == "table" then
            local count = 0
            for _ in pairs(value) do count += 1 end
            print("TABLE " .. key .. " [" .. count .. " entries]")
            
            for subKey, subValue in pairs(value) do
                if typeof(subValue) == "table" then
                    local subCount = 0
                    for _ in pairs(subValue) do subCount += 1 end
                    print("   TABLE " .. subKey .. " [" .. subCount .. " entries]")
                    
                    for deepKey, deepValue in pairs(subValue) do
                        if typeof(deepValue) == "table" then
                            local deepCount = 0
                            for _ in pairs(deepValue) do deepCount += 1 end
                            print("      TABLE " .. deepKey .. " [" .. deepCount .. " entries]")
                        else
                            print("      " .. deepKey .. " = " .. tostring(deepValue))
                        end
                    end
                else
                    print("   " .. subKey .. " = " .. tostring(subValue))
                end
            end
        else
            print(key .. " = " .. tostring(value))
        end
    end

    print("QUESTS DEEP DIVE COMPLETE")
end)
