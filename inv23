-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Player
local player = Players.LocalPlayer

-- Function to recursively print table contents
local function printTable(t, indent)
    indent = indent or 0
    for key, value in pairs(t) do
        local formatting = string.rep("  ", indent) .. tostring(key) .. ": "
        if type(value) == "table" then
            print(formatting .. "[TABLE]")
            printTable(value, indent + 1)
        else
            print(formatting .. tostring(value))
        end
    end
end

-- Function to inspect chars_connected_to_me and states
local function inspectNestedTables()
    print("ğŸ” INSPECTING chars_connected_to_me AND states")
    print("===========================================")

    -- Safely require ClientData
    local success, clientData = pcall(function() return require(ReplicatedStorage.ClientModules.Core.ClientData) end)
    if not success then
        warn("Failed to require ClientData:", clientData)
        return
    end

    -- Safely get player data
    local success, data = pcall(function() return clientData.get_data()[player.Name] end)
    if not success then
        warn("Failed to get player data:", data)
        return
    end

    -- Access pet_state_managers
    local petStateManagers = data.pet_state_managers
    if not petStateManagers then
        print("âŒ pet_state_managers not found in player data")
        return
    end

    -- Access the first pet entry (assuming it's at index 1)
    local petEntry = petStateManagers[1]
    if not petEntry then
        print("âŒ No pet entry found in pet_state_managers")
        return
    end

    -- Inspect chars_connected_to_me
    if petEntry.chars_connected_to_me then
        print("ğŸ“‹ Contents of chars_connected_to_me:")
        printTable(petEntry.chars_connected_to_me, 2)
    else
        print("âŒ chars_connected_to_me not found in pet entry")
    end

    -- Inspect states
    if petEntry.states then
        print("\nğŸ“‹ Contents of states:")
        printTable(petEntry.states, 2)
    else
        print("âŒ states not found in pet entry")
    end
end

-- Run the function
inspectNestedTables()
