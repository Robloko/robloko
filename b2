-- Test function to verify ExitSeatStates works
local function testExitSeatStates()
    debugPrint("TEST: Calling ExitSeatStates directly...")
    local success, result = pcall(function()
        return game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("AdoptAPI/ExitSeatStates"):FireServer()
    end)
    if success then
        debugPrint("TEST: ExitSeatStates call SUCCESSFUL")
    else
        debugPrint("TEST: ExitSeatStates call FAILED: " .. tostring(result))
    end
    return success
end

-- Call ExitSeatStates after furniture use (FIXED version)
local function callExitSeatStates()
    debugPrint("Calling ExitSeatStates to reset seat states...")
    local success, result = pcall(function()
        return game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("AdoptAPI/ExitSeatStates"):FireServer()
    end)
    if success then
        debugPrint("Successfully called ExitSeatStates")
    else
        debugPrint("Failed to call ExitSeatStates: " .. tostring(result))
    end
end

-- Use furniture with localPlayer (FIXED version with correct ExitSeatStates)
local function useFurnitureWithLocalPlayer(furnitureName)
    debugPrint("Using furniture for baby: " .. furnitureName .. " on localPlayer")
    local success = activateFurniture(furnitureName)
    
    if success then
        debugPrint("Successfully activated: " .. furnitureName)
        debugPrint("Waiting 20 seconds for cure...")
        task.wait(20) -- Wait for ailment cure
        
        -- Call ExitSeatStates after furniture use
        callExitSeatStates()
        
        task.wait(2)
        debugPrint("Furniture use sequence completed for: " .. furnitureName)
        return true
    else
        debugPrint("Failed to activate furniture with localPlayer: " .. furnitureName)
        return false
    end
end
