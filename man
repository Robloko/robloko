-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Player
local player = Players.LocalPlayer

-- Function to safely get player data
local function getPlayerData()
    local success, clientData = pcall(require, ReplicatedStorage.ClientModules.Core.ClientData)
    if not success then
        print("âŒ Failed to load ClientData module")
        return nil
    end
    
    local playerData = clientData.get_data()
    if not playerData or not playerData[player.Name] then
        print("âŒ No data found for player: " .. player.Name)
        return nil
    end
    
    return playerData[player.Name]
end

-- Function to inspect a specific manager in detail
local function inspectManagerDetails(managerName, managerData)
    print("\nğŸ¯ " .. managerName .. ":")
    print("   Type: " .. type(managerData))
    
    if type(managerData) ~= "table" then
        print("   Value: " .. tostring(managerData))
        return
    end
    
    local itemCount = 0
    for _ in pairs(managerData) do itemCount = itemCount + 1 end
    print("   Total Items: " .. itemCount)
    print("   ---")
    
    -- Inspect each sub-table in detail
    for key, value in pairs(managerData) do
        local valueType = type(value)
        
        if valueType == "table" then
            local subItemCount = 0
            for _ in pairs(value) do subItemCount = subItemCount + 1 end
            
            print("   ğŸ“ " .. key .. " [TABLE with " .. subItemCount .. " items]")
            
            -- Show first 3 items of each sub-table
            local count = 0
            for subKey, subValue in pairs(value) do
                count = count + 1
                if count <= 3 then
                    local subValueType = type(subValue)
                    if subValueType == "table" then
                        local deepCount = 0
                        for _ in pairs(subValue) do deepCount = deepCount + 1 end
                        print("      â””â”€ ğŸ“ " .. tostring(subKey) .. " [TABLE with " .. deepCount .. " items]")
                    else
                        print("      â””â”€ ğŸ“„ " .. tostring(subKey) .. " = " .. tostring(subValue) .. " [" .. subValueType .. "]")
                    end
                end
            end
            if count > 3 then
                print("      â””â”€ ... and " .. (count - 3) .. " more items")
            end
            
        else
            print("   ğŸ“„ " .. key .. " = " .. tostring(value) .. " [" .. valueType .. "]")
        end
    end
end

-- Enhanced function to inspect specific manager categories in detail
local function inspectSpecificManagers()
    print("ğŸ” DETAILED INSPECTION OF MANAGER CATEGORIES")
    print("============================================")
    
    local data = getPlayerData()
    if not data then return end
    
    -- List of managers to inspect (from your screenshots)
    local managersToInspect = {
        "AILMENTS_MANAGER",
        "PET_STATE_MANAGERS", 
        "QUEST_MANAGER",
        "ADMIN_ABUSE_MANAGER",
        "STATE_MANAGER_RAW"
    }
    
    for _, managerName in pairs(managersToInspect) do
        local managerData = data[managerName]
        
        if managerData then
            inspectManagerDetails(managerName, managerData)
        else
            -- Try case-insensitive search
            local found = false
            for actualName, actualData in pairs(data) do
                if string.lower(actualName) == string.lower(managerName) then
                    inspectManagerDetails(actualName, actualData)
                    found = true
                    break
                end
            end
            if not found then
                print("âŒ " .. managerName .. " not found in player data")
            end
        end
        print("") -- Empty line for separation
    end
end

-- Specialized function for AILMENTS_MANAGER
local function inspectAilmentsManager()
    print("\nğŸ¥ SPECIAL INSPECTION: AILMENTS_MANAGER")
    print("=====================================")
    
    local data = getPlayerData()
    if not data then return end
    
    local ailmentsManager = data.AILMENTS_MANAGER
    if not ailmentsManager then
        print("âŒ AILMENTS_MANAGER not found")
        return
    end
    
    -- Inspect schedules
    if ailmentsManager.schedules then
        print("ğŸ“… SCHEDULES:")
        local count = 0
        for scheduleKey, scheduleData in pairs(ailmentsManager.schedules) do
            count = count + 1
            if count <= 5 then
                print("   " .. tostring(scheduleKey) .. ": " .. tostring(scheduleData))
            end
        end
        if count > 5 then
            print("   ... and " .. (count - 5) .. " more schedules")
        end
    else
        print("âŒ No schedules found")
    end
    
    -- Inspect baby_ailments
    if ailmentsManager.baby_ailments then
        print("\nğŸ‘¶ BABY AILMENTS:")
        local count = 0
        for ailmentKey, ailmentData in pairs(ailmentsManager.baby_ailments) do
            count = count + 1
            if count <= 5 then
                if type(ailmentData) == "table" then
                    print("   " .. tostring(ailmentKey) .. " [TABLE]")
                    for k, v in pairs(ailmentData) do
                        print("      " .. tostring(k) .. ": " .. tostring(v))
                    end
                else
                    print("   " .. tostring(ailmentKey) .. ": " .. tostring(ailmentData))
                end
            end
        end
        if count > 5 then
            print("   ... and " .. (count - 5) .. " more baby ailments")
        end
    else
        print("âŒ No baby ailments found")
    end
    
    -- Inspect ailments
    if ailmentsManager.ailments then
        print("\nğŸ¤’ AILMENTS:")
        local count = 0
        for ailmentKey, ailmentData in pairs(ailmentsManager.ailments) do
            count = count + 1
            if count <= 5 then
                if type(ailmentData) == "table" then
                    print("   " .. tostring(ailmentKey) .. " [TABLE]")
                    for k, v in pairs(ailmentData) do
                        print("      " .. tostring(k) .. ": " .. tostring(v))
                    end
                else
                    print("   " .. tostring(ailmentKey) .. ": " .. tostring(ailmentData))
                end
            end
        end
        if count > 5 then
            print("   ... and " .. (count - 5) .. " more ailments")
        end
    else
        print("âŒ No ailments found")
    end
end

-- Specialized function for QUEST_MANAGER
local function inspectQuestManager()
    print("\nğŸ¯ SPECIAL INSPECTION: QUEST_MANAGER")
    print("===================================")
    
    local data = getPlayerData()
    if not data then return end
    
    local questManager = data.QUEST_MANAGER
    if not questManager then
        print("âŒ QUEST_MANAGER not found")
        return
    end
    
    -- Inspect quests_cached
    if questManager.quests_cached then
        print("ğŸ’¾ QUESTS CACHED:")
        local count = 0
        for questKey, questData in pairs(questManager.quests_cached) do
            count = count + 1
            if count <= 5 then
                if type(questData) == "table" then
                    print("   " .. tostring(questKey) .. " [TABLE]")
                    for k, v in pairs(questData) do
                        print("      " .. tostring(k) .. ": " .. tostring(v))
                    end
                else
                    print("   " .. tostring(questKey) .. ": " .. tostring(questData))
                end
            end
        end
        if count > 5 then
            print("   ... and " .. (count - 5) .. " more cached quests")
        end
    else
        print("âŒ No quests cached found")
    end
    
    -- Inspect daily_quest_data
    if questManager.daily_quest_data then
        print("\nğŸ“… DAILY QUEST DATA:")
        local count = 0
        for dailyKey, dailyData in pairs(questManager.daily_quest_data) do
            count = count + 1
            if count <= 5 then
                if type(dailyData) == "table" then
                    print("   " .. tostring(dailyKey) .. " [TABLE]")
                    for k, v in pairs(dailyData) do
                        print("      " .. tostring(k) .. ": " .. tostring(v))
                    end
                else
                    print("   " .. tostring(dailyKey) .. ": " .. tostring(dailyData))
                end
            end
        end
        if count > 5 then
            print("   ... and " .. (count - 5) .. " more daily quest items")
        end
    else
        print("âŒ No daily quest data found")
    end
end

-- Simple function to just list all available managers
local function listAllManagers()
    print("ğŸ“‹ LISTING ALL MANAGER CATEGORIES")
    print("=================================")
    
    local data = getPlayerData()
    if not data then return end
    
    local managerCount = 0
    
    for categoryName, categoryData in pairs(data) do
        if string.find(string.lower(categoryName), "manager") then
            managerCount = managerCount + 1
            local itemCount = 0
            if type(categoryData) == "table" then
                for _ in pairs(categoryData) do itemCount = itemCount + 1 end
            end
            print("ğŸ¯ " .. categoryName .. " (" .. itemCount .. " items)")
        end
    end
    
    if managerCount == 0 then
        print("âŒ No manager categories found")
    else
        print("\nğŸ“Š Total manager categories: " .. managerCount)
    end
end

-- Main execution
print("ğŸš€ STARTING MANAGER INSPECTION...")
listAllManagers()
inspectSpecificManagers()
inspectAilmentsManager()
inspectQuestManager()
print("âœ… INSPECTION COMPLETE")
