--[[
    Improved ClientData Inspector
    ------------------------------
    This script safely inspects the 'ClientData' module and its 'get_data' function.
    It's a more robust version of the original script.
]]

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Player
local player = Players.LocalPlayer

-- Configuration
local CLIENT_DATA_MODULE_PATH = ReplicatedStorage:WaitForChild("ClientModules"):WaitForChild("Core"):WaitForChild("ClientData")


-- Main inspection function
local function inspectClientData()
    print("üîç INSPECTING CLIENTDATA API")
    print("============================")

    -- 1. Safely require the module
    local success, clientDataModule = pcall(function()
        return require(CLIENT_DATA_MODULE_PATH)
    end)

    if not success then
        print("‚ùå Failed to load ClientData module at path: " .. CLIENT_DATA_MODULE_PATH:GetFullName())
        print("   Error: " .. tostring(clientDataModule))
        return
    end
    print("‚úÖ ClientData module loaded successfully.")

    -- 2. Check if the 'get_data' function exists
    if typeof(clientDataModule.get_data) ~= "function" then
        print("‚ùå The 'get_data' function was not found in the ClientData module.")
        return
    end
    print("‚úÖ 'get_data' function found.")

    -- 3. Safely call the 'get_data' function
    local success2, allData = pcall(function()
        return clientDataModule.get_data()
    end)

    if not success2 then
        print("‚ùå Failed to call get_data().")
        print("   Error: " .. tostring(allData))
        return
    end
    print("‚úÖ get_data() executed successfully.")

    -- 4. Check if player data exists within the returned data
    if typeof(allData) ~= "table" then
        print("‚ùå get_data() did not return a table. Returned type: " .. typeof(allData))
        return
    end

    local playerData = allData[player.Name]
    if not playerData then
        print("‚ùå No data found for player: " .. player.Name)
        return
    end
    print("‚úÖ Found data for player: " .. player.Name)

    -- 5. List all categories in the player's data
    print("\nüìã Found the following data categories:")
    for categoryName, categoryData in pairs(playerData) do
        -- We use typeof() here because it's more robust than type() for Roblox objects
        print(string.format("  - %s (%s)", categoryName, typeof(categoryData)))
    end
    
    print("\n‚úÖ Inspection complete.")
end

-- Run the function
inspectClientData()
