local Players = game:GetService("Players")
local VirtualUser = game:GetService("VirtualUser")
local player = Players.LocalPlayer

-- Function to enable anti-AFK
local function enableAntiAFK()
    -- Method 1: Disable existing Idled connections if getconnections is available (e.g., in exploits)
    if getconnections then
        for _, connection in pairs(getconnections(player.Idled)) do
            if connection.Disconnect then
                connection:Disconnect()
            end
        end
        -- Reconnect with our own handler
        player.Idled:Connect(function()
            VirtualUser:CaptureController()
            VirtualUser:ClickButton2(Vector2.new())
        end)
    else
        -- Method 2: Fallback for standard Roblox (no exploits)
        player.Idled:Connect(function()
            VirtualUser:CaptureController()
            VirtualUser:ClickButton2(Vector2.new())
        end)
    end
    
    -- Optional: Notify the player (remove if you don't want notifications)
    game.StarterGui:SetCore("SendNotification", {
        Title = "Anti-AFK";
        Text = "Anti-idle is now enabled!";
        Duration = 3;
    })
end
