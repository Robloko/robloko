-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Player
local player = Players.LocalPlayer

-- Helper function to count table items safely
local function countTableItems(tbl)
    if type(tbl) ~= "table" then return 0 end
    local count = 0
    for _ in pairs(tbl) do count = count + 1 end
    return count
end

-- Function to safely inspect HOUSE MANAGER
local function inspectHouseManager()
    print("ğŸ  INSPECTING HOUSE MANAGER")
    print("===========================")
    
    -- Get client data
    local clientData = require(ReplicatedStorage.ClientModules.Core.ClientData)
    local playerData = clientData.get_data()[player.Name]
    
    if not playerData then
        print("âŒ No player data found")
        return
    end
    
    if not playerData.house_manager then
        print("âŒ house_manager not found in player data")
        print("ğŸ“‹ Available data keys:")
        for key, value in pairs(playerData) do
            if type(value) == "table" then
                print("   ğŸ“ " .. key .. " [TABLE]")
            else
                print("   ğŸ“„ " .. key .. " = " .. tostring(value))
            end
        end
        return
    end
    
    local houseManager = playerData.house_manager
    
    print("âœ… HOUSE MANAGER FOUND!")
    print("Total keys in house_manager: " .. countTableItems(houseManager))
    print("")
    
    -- List all top-level properties
    for key, value in pairs(houseManager) do
        if type(value) == "table" then
            local itemCount = countTableItems(value)
            print("ğŸ“ " .. key .. " [TABLE with " .. itemCount .. " items]")
            
            -- Show first 5 items of each table
            local displayed = 0
            for k, v in pairs(value) do
                if displayed < 5 then
                    if type(v) == "table" then
                        local subCount = countTableItems(v)
                        print("   â”œâ”€ " .. tostring(k) .. " = [TABLE with " .. subCount .. " items]")
                    else
                        print("   â”œâ”€ " .. tostring(k) .. " = " .. tostring(v))
                    end
                    displayed = displayed + 1
                else
                    break
                end
            end
            if itemCount > 5 then
                print("   â””â”€ ... and " .. (itemCount - 5) .. " more items")
            end
        else
            print("ğŸ“„ " .. key .. " = " .. tostring(value))
        end
    end
    
    print("")
    print("ğŸ” DEEP INSPECTION OF KEY TABLES:")
    print("=================================")
    
    -- Deep inspect specific important tables
    local importantTables = {"houses", "house_data", "decorations", "furniture", "placed_items"}
    
    for _, tableName in ipairs(importantTables) do
        if houseManager[tableName] and type(houseManager[tableName]) == "table" then
            print("")
            print("ğŸ“‚ " .. tableName .. ":")
            local tableData = houseManager[tableName]
            local totalItems = countTableItems(tableData)
            
            print("   Total items: " .. totalItems)
            
            -- Show all items in important tables
            local displayed = 0
            for key, value in pairs(tableData) do
                displayed = displayed + 1
                if type(value) == "table" then
                    local subCount = countTableItems(value)
                    print("   â”œâ”€ [" .. tostring(key) .. "] = TABLE with " .. subCount .. " items")
                    
                    -- Show first 3 sub-items
                    local subDisplayed = 0
                    for subKey, subValue in pairs(value) do
                        if subDisplayed < 3 then
                            if type(subValue) == "table" then
                                print("   â”‚  â”œâ”€ " .. tostring(subKey) .. " = [TABLE]")
                            else
                                print("   â”‚  â”œâ”€ " .. tostring(subKey) .. " = " .. tostring(subValue))
                            end
                            subDisplayed = subDisplayed + 1
                        else
                            break
                        end
                    end
                    if subCount > 3 then
                        print("   â”‚  â””â”€ ... and " .. (subCount - 3) .. " more")
                    end
                else
                    print("   â”œâ”€ [" .. tostring(key) .. "] = " .. tostring(value))
                end
                
                -- Limit output for very large tables
                if displayed >= 10 and totalItems > 10 then
                    print("   â””â”€ ... and " .. (totalItems - 10) .. " more items")
                    break
                end
            end
        end
    end
end

-- Run the inspection
inspectHouseManager()
