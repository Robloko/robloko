-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Player
local player = Players.LocalPlayer

-- Function to safely find and inspect ClientData
local function findAndInspectClientData()
    print("üîç SEARCHING FOR CLIENT DATA MODULE...")
    print("======================================")
    
    -- First, let's check if ReplicatedStorage exists and has the expected structure
    if not ReplicatedStorage then
        print("‚ùå ReplicatedStorage not found!")
        return
    end
    
    print("üìÅ ReplicatedStorage contents:")
    for _, child in pairs(ReplicatedStorage:GetChildren()) do
        print("   " .. child.Name .. " (" .. child.ClassName .. ")")
    end
    print("")
    
    -- Look for ClientModules
    local clientModules = ReplicatedStorage:FindFirstChild("ClientModules")
    if clientModules then
        print("üìÅ ClientModules contents:")
        for _, child in pairs(clientModules:GetChildren()) do
            print("   " .. child.Name .. " (" .. child.ClassName .. ")")
        end
        print("")
        
        -- Look for Core folder
        local coreModule = clientModules:FindFirstChild("Core")
        if coreModule then
            print("üìÅ Core contents:")
            for _, child in pairs(coreModule:GetChildren()) do
                print("   " .. child.Name .. " (" .. child.ClassName .. ")")
            end
            print("")
            
            -- Look for ClientData
            local clientDataModule = coreModule:FindFirstChild("ClientData")
            if clientDataModule and clientDataModule:IsA("ModuleScript") then
                print("‚úÖ Found ClientData ModuleScript!")
                
                -- Try to require the module
                local success, clientData = pcall(require, clientDataModule)
                if success then
                    print("‚úÖ Successfully required ClientData module")
                    
                    -- Try to get player data
                    local playerData = clientData.get_data()
                    if playerData then
                        print("‚úÖ Successfully got player data")
                        
                        if playerData[player.Name] then
                            print("‚úÖ Found data for player: " .. player.Name)
                            return playerData[player.Name]
                        else
                            print("‚ùå No data found for player: " .. player.Name)
                        end
                    else
                        print("‚ùå get_data() returned nil")
                    end
                else
                    print("‚ùå Failed to require ClientData: " .. tostring(clientData))
                end
            else
                print("‚ùå ClientData ModuleScript not found in Core")
            end
        else
            print("‚ùå Core folder not found in ClientModules")
        end
    else
        print("‚ùå ClientModules not found in ReplicatedStorage")
    end
    
    return nil
end

-- Function to inspect HOUSE MANAGER if we have data
local function inspectHouseManager()
    print("")
    print("üè† INSPECTING HOUSE MANAGER")
    print("===========================")
    
    local playerData = findAndInspectClientData()
    
    if not playerData then
        print("‚ùå Could not retrieve player data")
        return
    end
    
    if playerData.house_manager then
        local houseManager = playerData.house_manager
        
        print("‚úÖ HOUSE MANAGER FOUND!")
        print("Total keys in house_manager: " .. tostring(countTableItems(houseManager)))
        print("")
        
        -- List all top-level properties
        for key, value in pairs(houseManager) do
            if type(value) == "table" then
                local itemCount = countTableItems(value)
                print("üìÅ " .. key .. " [TABLE with " .. itemCount .. " items]")
                
                -- Show first few items of each table
                local displayed = 0
                for k, v in pairs(value) do
                    if displayed < 3 then  -- Limit to 3 items per table to avoid spam
                        if type(v) == "table" then
                            print("   ‚îî‚îÄ " .. k .. " = [TABLE]")
                        else
                            print("   ‚îî‚îÄ " .. k .. " = " .. tostring(v))
                        end
                        displayed = displayed + 1
                    end
                end
                if displayed < countTableItems(value) then
                    print("   ‚îî‚îÄ ... and " .. (countTableItems(value) - displayed) .. " more items")
                end
            else
                print("üìÑ " .. key .. " = " .. tostring(value))
            end
        end
    else
        print("‚ùå house_manager not found in player data")
        
        -- Show what IS available in player data
        print("")
        print("üìã AVAILABLE DATA IN PLAYER:")
        for key, value in pairs(playerData) do
            if type(value) == "table" then
                print("üìÅ " .. key .. " [TABLE]")
            else
                print("üìÑ " .. key .. " = " .. tostring(value))
            end
        end
    end
end

-- Helper function to count table items
local function countTableItems(tbl)
    local count = 0
    for _ in pairs(tbl) do count = count + 1 end
    return count
end

-- Run the inspection
inspectHouseManager()
