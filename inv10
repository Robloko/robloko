-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Player
local player = Players.LocalPlayer

-- Function to deeply inspect HOUSE MANAGER
local function inspectHouseManagerDeep()
    print("ğŸ” DEEP INSPECTION: HOUSE MANAGER")
    print("=================================")
    
    local clientData = require(ReplicatedStorage.ClientModules.Core.ClientData)
    local data = clientData.get_data()[player.Name]
    
    if not data.house_manager then
        print("âŒ No house_manager found in player data")
        return
    end
    
    local houseManager = data.house_manager
    
    -- Basic house manager info
    print("ğŸ  HOUSE MANAGER OVERVIEW:")
    print("   Total keys: " .. tostring(#houseManager))
    for key, value in pairs(houseManager) do
        if type(value) == "table" then
            local count = 0
            for _ in pairs(value) do count = count + 1 end
            print("   ğŸ“ " .. key .. " [TABLE with " .. count .. " items]")
        else
            print("   ğŸ“„ " .. key .. " = " .. tostring(value))
        end
    end
    print("")
    
    -- Deep inspection of each table within house_manager
    for category, categoryData in pairs(houseManager) do
        if type(categoryData) == "table" then
            print("ğŸ“‚ DEEP INSPECTION: " .. category)
            print("   " .. string.rep("-", 40))
            
            local itemCount = 0
            local tableCount = 0
            local valueCount = 0
            
            for key, value in pairs(categoryData) do
                itemCount = itemCount + 1
                
                if type(value) == "table" then
                    tableCount = tableCount + 1
                    local subItemCount = 0
                    for _ in pairs(value) do subItemCount = subItemCount + 1 end
                    
                    print("   ğŸ“ " .. key .. " [SUB-TABLE with " .. subItemCount .. " items]")
                    
                    -- Inspect sub-table contents
                    for subKey, subValue in pairs(value) do
                        if type(subValue) == "table" then
                            local deepCount = 0
                            for _ in pairs(subValue) do deepCount = deepCount + 1 end
                            print("      ğŸ“ " .. subKey .. " [DEEP-TABLE with " .. deepCount .. " items]")
                        else
                            print("      ğŸ“„ " .. subKey .. " = " .. tostring(subValue))
                        end
                    end
                else
                    valueCount = valueCount + 1
                    print("   ğŸ“„ " .. key .. " = " .. tostring(value))
                end
            end
            
            print("   ğŸ“Š SUMMARY: " .. itemCount .. " total items (" .. tableCount .. " tables, " .. valueCount .. " values)")
            print("")
        end
    end
    
    -- Special inspection for common house-related categories
    local importantCategories = {"houses", "house_data", "house_items", "decorations", "furniture"}
    
    print("ğŸ¯ IMPORTANT HOUSE CATEGORIES INSPECTION:")
    print("   " .. string.rep("-", 50))
    
    for _, category in ipairs(importantCategories) do
        if houseManager[category] then
            print("   ğŸ” " .. category .. ":")
            local catData = houseManager[category]
            
            if type(catData) == "table" then
                -- Check if it's an array-like table or dictionary
                local isArray = false
                for k in pairs(catData) do
                    if type(k) == "number" then
                        isArray = true
                        break
                    end
                end
                
                if isArray then
                    print("      ğŸ“‹ ARRAY with " .. #catData .. " elements")
                    for i, item in ipairs(catData) do
                        if type(item) == "table" then
                            local props = 0
                            for _ in pairs(item) do props = props + 1 end
                            print("         [" .. i .. "] TABLE with " .. props .. " properties")
                        else
                            print("         [" .. i .. "] = " .. tostring(item))
                        end
                    end
                else
                    print("      ğŸ—‚ï¸ DICTIONARY with " .. countTableItems(catData) .. " items")
                    for key, value in pairs(catData) do
                        if type(value) == "table" then
                            local count = countTableItems(value)
                            print("         ğŸ“ " .. key .. " [TABLE with " .. count .. " items]")
                        else
                            print("         ğŸ“„ " .. key .. " = " .. tostring(value))
                        end
                    end
                end
            else
                print("      ğŸ“„ " .. tostring(catData))
            end
        else
            print("   âŒ " .. category .. ": NOT FOUND")
        end
        print("")
    end
end

-- Helper function to count table items
local function countTableItems(tbl)
    local count = 0
    for _ in pairs(tbl) do count = count + 1 end
    return count
end

-- Run the deep inspection
inspectHouseManagerDeep()
