-- Adopt Me! NURSERY + PET RELEASER AUTO-FARMER + TOGGLE UI ♻️
-- Click the ♻️ button to START/STOP farming!

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local VirtualInputManager = game:GetService("VirtualInputManager")
local HttpService = game:GetService("HttpService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")

local player = Players.LocalPlayer
local API = ReplicatedStorage:WaitForChild("API")
local clientData = require(ReplicatedStorage.ClientModules.Core.ClientData)

-- === FARM STATE ===
local FARMING = false
local farmConnection = nil

-- === DEBUG PRINT ===
local function debugPrint(msg)
    print("[NurseryFarmer] " .. tostring(msg))
end

-- === [ALL YOUR FUNCTIONS FROM BEFORE: getValidCharacter, exitHouse, teleportTo, setCamera, etc.] ===
-- (I'm keeping them exactly the same — just paste them here from previous script)

-- Paste ALL functions from the last script here:
-- getValidCharacter, exitHouse, teleportTo, setCamera, resetCamera, simulateWKeyPress, 
-- isNearPosition, teleportToNursery, getAllPets, getNeonOldPets, getTargetDupes, 
-- countCrystalEggs, releasePets, claimRewards, farmCycle

-- === TINY UI BUTTON WITH ♻️ ICON ===
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "NurseryFarmUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = CoreGui

local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0, 70, 0, 70)
toggleButton.Position = UDim2.new(0, 95, 0, 15)
toggleButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
toggleButton.BorderSizePixel = 0
 サtoggleButton.Text = "♻️\nOFF"
toggleButton.TextColor3 = Color3.fromRGB(255, 80, 80)
toggleButton.TextScaled = true
toggleButton.Font = Enum.Font.GothamBold
toggleButton.BackgroundTransparency = 0.3
toggleButton.Parent = screenGui

-- Rounded corners + shadow
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 35)
corner.Parent = toggleButton

local stroke = Instance.new("UIStroke")
stroke.Thickness = 4
stroke.Color = Color3.fromRGB(255, 80, 80)
stroke.Parent = toggleButton

-- Glow effect
local glow = Instance.new("ImageLabel")
glow.Size = UDim2.new(1.3, 0, 1.3, 0)
glow.Position = UDim2.new(-0.15, 0, -0.15, 0)
glow.BackgroundTransparency = 1
glow.Image = "rbxassetid://241575762" -- Roblox glow
glow.ImageColor3 = Color3.fromRGB(255, 80, 80)
glow.ImageTransparency = 0.7
glow.ZIndex = 0
glow.Parent = toggleButton

-- === TOGGLE FUNCTION ===
local function toggleFarming()
    FARMING = not FARMING

    if FARMING then
        toggleButton.Text = "♻️\nON"
        toggleButton.TextColor3 = Color3.fromRGB(80, 255, 80)
        stroke.Color = Color3.fromRGB(80, 255, 80)
        glow.ImageColor3 = Color3.fromRGB(80, 255, 255)
        TweenService:Create(glow, TweenInfo.new(0.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {ImageTransparency = 0.4}):Play()
        debugPrint("FARMING STARTED! ♻️")
        
        -- Start loop
        farmConnection = task.spawn(function()
            while FARMING do
                farmCycle()
                task.wait(2)
            end
        end)
    else
        toggleButton.Text = "♻️\nOFF"
        toggleButton.TextColor3 = Color3.fromRGB(255, 80, 80)
        stroke.Color = Color3.fromRGB(255, 80, 80)
        glow.ImageColor3 = Color3.fromRGB(255, 80, 80)
        glow.ImageTransparency = 0.9
        debugPrint("FARMING STOPPED.")
        
        if farmConnection then
            task.cancel(farmConnection)
            farmConnection = nil
        end
    end
end

-- Click to toggle
toggleButton.MouseButton1Click:Connect(toggleFarming)

-- Optional: Drag button
local dragging = false
local dragStart, startPos
toggleButton.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = toggleButton.Position
    end
end)

toggleButton.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        toggleButton.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

toggleButton.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- === NOTIFY ON LOAD ===
debugPrint("Nursery Farmer UI LOADED! Click ♻️ to START")
toggleButton.Text = "♻️\nREADY"

-- === PASTE ALL YOUR FUNCTIONS BELOW THIS LINE ===
-- (Copy-paste everything from teleportToNursery, releasePets, farmCycle, etc.)

-- === [PASTE ALL FUNCTIONS HERE] ===
-- ... (all your functions from the previous script)

-- Example placeholder (replace with real ones):
local function farmCycle() 
    debugPrint("FARM CYCLE RUNNING... (full version required)")
end

-- === AUTO-START OPTION (remove if you want manual only) ===
-- toggleFarming() -- Uncomment to auto-start

print("♻️ NURSERY FARMER UI READY! Click the button to farm Crystal Eggs!")
